Sub credit_card():Dim ws As WorksheetFor Each ws In Worksheets    Dim tiker_symbol As String    Dim vol As Double    Dim lastRow As Double    Dim SummaryT As Integer    Dim opening_price As Double    Dim closing_price As Double    Dim year_change As Double    Dim percentage_change As Double    Dim i As Long    Dim j As Long        ws.Cells(1, 9).Value = "Ticker"    ws.Cells(1, 10).Value = "Yearly Change"    ws.Cells(1, 11).Value = "Percent Change"    ws.Cells(1, 12).Value = "Total Stock Volume"        vol = 0    year_change = 0    percentage_change = 0    SummaryT = 2            lastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row    For i = 2 To lastRow                If ws.Cells(i, 1).Value <> ws.Cells(i - 1, 1).Value Then            ticker_symbol = ws.Cells(i, 1).Value            opening_price = ws.Cells(i, 3).Value        End If                If i = lastRow Or ws.Cells(i + 1, 1).Value <> ticker_symbol Then                       closing_price = ws.Cells(i, 6).Value            year_change = closing_price - opening_price                        percentage_change = year_change / opening_price                        vol = vol + ws.Cells(i, 7).Value            ws.Range("I" & SummaryT).Value = ticker_symbol            ws.Range("J" & SummaryT).Value = year_change            ws.Range("J" & SummaryT).NumberFormat = "$#,##0.00"            ws.Range("K" & SummaryT).Value = percentage_change            ws.Range("K" & SummaryT).NumberFormat = "0.00%"            ws.Range("L" & SummaryT).Value = vol                        SummaryT = SummaryT + 1            vol = 0                     Else            vol = vol + ws.Cells(i, 7).Value        End If    Next i       Dim max_increase_ticker As StringDim max_increase As DoubleDim max_decrease_ticker As StringDim max_decrease As DoubleDim max_volume_ticker As StringDim max_volume As Double    ws.Cells(2, 14).Value = "Greatest % Increase"    ws.Cells(3, 14).Value = "Greatest % Decrease"    ws.Cells(4, 14).Value = "Greatest Total Volume"    ws.Cells(1, 15).Value = "Ticker"    ws.Cells(1, 16).Value = "Value"        max_increase = WorksheetFunction.Max(ws.Range("K2:K" & SummaryT))    max_decrease = WorksheetFunction.Min(ws.Range("K2:K" & SummaryT))    max_volume = WorksheetFunction.Max(ws.Range("L2:L" & SummaryT))         For i = 2 To SummaryT            If ws.Cells(i, 11).Value = max_increase Then            max_increase_ticker = ws.Cells(i, 9).Value            Exit For        End If    Next i        ws.Range("O2").Value = max_increase_ticker    ws.Range("P2").Value = max_increase    ws.Range("P2").NumberFormat = "0.00%"    For i = 2 To SummaryT        If ws.Cells(i, 11).Value = max_decrease Then            max_decrease_ticker = ws.Cells(i, 9).Value            Exit For        End If    Next i    ws.Range("O3").Value = max_decrease_ticker    ws.Range("P3").Value = max_decrease    ws.Range("P3").NumberFormat = "0.00%"        For i = 2 To SummaryT        If ws.Cells(i, 12).Value = max_volume Then            max_volume_ticker = ws.Cells(i, 9).Value            Exit For        End If    Next i    ws.Range("O4").Value = max_volume_ticker    ws.Range("P4").Value = max_volumews.Cells.EntireColumn.AutoFit    With ws                Dim rng As Range        Set rng = .Range("J2:K" & lastRow)        With rng.FormatConditions.Add(Type:=xlCellValue, Operator:=xlGreater, Formula1:="0")        .Interior.Color = RGB(0, 255, 0)        End With                With rng.FormatConditions.Add(Type:=xlCellValue, Operator:=xlLess, Formula1:="0")        .Interior.Color = RGB(255, 0, 0)        End With    End WithNext wsEnd Sub